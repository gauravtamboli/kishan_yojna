<ion-header>
  <ion-toolbar color="primary">
    <ion-buttons slot="start">
      <ion-back-button class="custom-back-button" (click)="goBack()" defaultHref="/landigpage"></ion-back-button>
    </ion-buttons>

    <ion-title class="responsive-toolbar-title">
      рдкреНрд░рдЧрддрд┐ рдкреНрд░рддрд┐рд╡реЗрджрди
    </ion-title>

    <ion-buttons slot="end">
      <ion-button (click)="exportToExcel()">
        Export To Excel
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>


<ion-content class="ion-padding">

  <div class="report-container">
    <h2 class="report-title">
      рдЕрдиреБрд╕рдВрдзрд╛рди рд╡рд┐рд╕реНрддрд╛рд░ рдкреНрд░рднрд╛рдЧ<br />
      рд╡рд┐рддреНрддреАрдп рд╡рд░реНрд╖ 2025тАУ26 рдореЗрдВ рдХрд┐рд╕рд╛рди рд╡реГрдХреНрд╖ рдорд┐рддреНрд░ рдпреЛрдЬрдирд╛ рдХреЗ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рдпрди / рд╡реГрдХреНрд╖рд╛рд░реЛрдкрдг рдХреА рдкреНрд░рдЧрддрд┐
    </h2>
    <p class="report-date">рджрд┐рдирд╛рдВрдХ: {{todayDate}}</p>

    <div class="table-wrapper">
      <table class="report-table">
        <thead>
          <tr #headerRow>
            <th rowspan="2">рдХреНрд░.</th>
            <th rowspan="2">рд╡реГрддреНрдд рдХрд╛ рдирд╛рдо</th>
            <th rowspan="2">рдЬрд┐рд▓реЗ рдХрд╛ рдирд╛рдо</th>
            <th rowspan="2">рд╡рдирдордВрдбрд▓ рдХрд╛ рдирд╛рдо</th>

            <th colspan="4">рдЯрд┐рд╢реНрдпреВ рдХрд▓реНрдЪрд░ рд╕рд╛рдЧреМрди</th>
            <th colspan="4">рд╕рд╛рдзрд╛рд░рдг рд╕рд╛рдЧреМрди</th>
            <th colspan="4">рдЯрд┐рд╢реНрдпреВ рдХрд▓реНрдЪрд░ рдмрд╛рдБрд╕</th>
            <th colspan="4">рд╕рд╛рдзрд╛рд░рдг рдмрд╛рдБрд╕</th>
            <th colspan="4">рдХреНрд▓реЛрдирд▓ рдиреАрд▓рдЧрд┐рд░реА</th>
            <th colspan="4">рдЪрдВрджрди рдкреМрдзрд╛</th>
            <th colspan="4">рдорд┐рд▓рд┐рдпрд╛ рдбреВрдмрд┐рдпрд╛</th>
            <th colspan="4">рдЕрдиреНрдп рдЖрд░реНрдерд┐рдХ рд▓рд╛рднрдХрд╛рд░реА рдкреМрдзрд╛</th>
            <th colspan="4">рдорд╣рд╛рдпреЛрдЧ</th>
            <th rowspan="2">рдкреНрд░рддрд┐рд╢рдд</th>
          </tr>

          <tr>
            <th>рдХрд┐рд╕рд╛рдиреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛</th>
            <th>рдХреНрд╖реЗрддреНрд░рдлрд▓ (рдПрдХрдбрд╝)</th>
            <th>рд░реЛрдкрдг рд▓рдХреНрд╖реНрдп</th>
            <th>рд░реЛрдкрд┐рдд рдкреМрдзреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛</th>

            <th>рдХрд┐рд╕рд╛рдиреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛</th>
            <th>рдХреНрд╖реЗрддреНрд░рдлрд▓ (рдПрдХрдбрд╝)</th>
            <th>рд░реЛрдкрдг рд▓рдХреНрд╖реНрдп</th>
            <th>рд░реЛрдкрд┐рдд рдкреМрдзреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛</th>

            <th>рдХрд┐рд╕рд╛рдиреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛</th>
            <th>рдХреНрд╖реЗрддреНрд░рдлрд▓ (рдПрдХрдбрд╝)</th>
            <th>рд░реЛрдкрдг рд▓рдХреНрд╖реНрдп</th>
            <th>рд░реЛрдкрд┐рдд рдкреМрдзреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛</th>

            <th>рдХрд┐рд╕рд╛рдиреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛</th>
            <th>рдХреНрд╖реЗрддреНрд░рдлрд▓ (рдПрдХрдбрд╝)</th>
            <th>рд░реЛрдкрдг рд▓рдХреНрд╖реНрдп</th>
            <th>рд░реЛрдкрд┐рдд рдкреМрдзреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛</th>

            <th>рдХрд┐рд╕рд╛рдиреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛</th>
            <th>рдХреНрд╖реЗрддреНрд░рдлрд▓ (рдПрдХрдбрд╝)</th>
            <th>рд░реЛрдкрдг рд▓рдХреНрд╖реНрдп</th>
            <th>рд░реЛрдкрд┐рдд рдкреМрдзреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛</th>

            <th>рдХрд┐рд╕рд╛рдиреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛</th>
            <th>рдХреНрд╖реЗрддреНрд░рдлрд▓ (рдПрдХрдбрд╝)</th>
            <th>рд░реЛрдкрдг рд▓рдХреНрд╖реНрдп</th>
            <th>рд░реЛрдкрд┐рдд рдкреМрдзреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛</th>

            <th>рдХрд┐рд╕рд╛рдиреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛</th>
            <th>рдХреНрд╖реЗрддреНрд░рдлрд▓ (рдПрдХрдбрд╝)</th>
            <th>рд░реЛрдкрдг рд▓рдХреНрд╖реНрдп</th>
            <th>рд░реЛрдкрд┐рдд рдкреМрдзреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛</th>

            <th>рдХрд┐рд╕рд╛рдиреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛</th>
            <th>рдХреНрд╖реЗрддреНрд░рдлрд▓ (рдПрдХрдбрд╝)</th>
            <th>рд░реЛрдкрдг рд▓рдХреНрд╖реНрдп</th>
            <th>рд░реЛрдкрд┐рдд рдкреМрдзреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛</th>

            <th>рдХреБрд▓ рдХрд┐рд╕рд╛рдиреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛</th>
            <th>рдХреБрд▓ рдХреНрд╖реЗрддреНрд░рдлрд▓ (рдПрдХрдбрд╝)</th>
            <th>рдХреБрд▓ рд░реЛрдкрдг рд▓рдХреНрд╖реНрдп</th>
            <th>рдХреБрд▓ рд░реЛрдкрд┐рдд рдкреМрдзреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛</th>

          </tr>

          <!-- ЁЯЯи AUTO COLUMN NUMBER ROW -->
          <tr class="number-row">
            <ng-container *ngFor="let n of columnNumbers">
              <td>{{ n }}</td>
            </ng-container>
          </tr>
        </thead>

        <!-- ЁЯЯз BODY -->
        <tbody>
          <tr *ngFor="let item of reportData; let i = index">
            <td>{{ i + 1 }}</td>
            <td>{{ item.circleName }}</td>
            <td>{{ item.districtName }}</td>
            <td>{{ item.divisionName }}</td>

            <!-- Example cells (add rest as needed) -->
            <td>{{ item.tc_sagwan_farmers }}</td>
            <td>{{ item.tc_sagwan_area }}</td>
            <td>{{ item.tc_sagwan_plants }}</td>
            <td>{{ item.tc_sagwan_planted }}</td>
            <!-- ... continue all other fields ... -->
          </tr>
        </tbody>
      </table>
    </div>


  </div>

</ion-content>